/ / / /  ———整体框图————————

┌────────────────────┐
│      OV7670摄像头   │
│  (图像采集模块)     │
└─────────┬──────────┘
          │ D0~D7 / VSYNC / PCLK
          │
┌─────────▼──────────┐
│   Arduino Uno       │
│                     │
│ ─ 数据接收          │
│ ─ 数据打包          │
│ ─ UART发送          │
│ ─ IO口控制28YB电机  │
└─▲───────┬──────┬───┘
  │       │UART  │IO
  │serial │      │    
  │       │      │
┌─────────▼─┐ ┌──▼────────────┐
│  PC上位机  │ │  28YB电机     │
│  Python   │ │ (执行机构)     │
│ ─ 串口接收 │ │ ─ 绕竖直轴旋转 │
│ ─ 图像重构 │ └───────────────┘
│ ─ OpenCV  │
│   人脸检测 │
│ ─ 串口指令 |
|   控制电机 │
└───────────┘


/  / / / / Arduino执行流程——————

┌──────────────────────┐
│  接收 PC 控制指令     │
│  (PC上一个周期发送的) │
└───────┬──────────────┘
        ▼
┌────────────────────┐
│ 初始化系统资源      │
│ - 串口 UART        │
│ - 摄像头 OV7670    │  
└───────┬───────────┘
        ▼
┌────────────────────┐
│ 摄像头初始化成功?  │
└───────┬──────────┬─┘
        │是         │否
        ▼           ▼
┌──────────────┐  ┌─────────┐
│ 等待 VSYNC   │  │  停止  │
│ (新一帧开始) │   └─────────┘
└───────┬──────┘
        ▼
┌─────────────────────────────────────────────┐
│ 采集一帧图像数据   │     │   在每一行采集前，  │ 
│ - D0~D7 并行读取   │    |  见缝插针运行舵机   |
│ - PCLK 同步        │    └───────┬───────────┘
└───────┬────────────┘
        ▼
┌────────────────────┐
│ 图像数据打包       │ 
│ - 行 / 帧标识       │
└───────┬────────────┘
        ▼
┌────────────────────┐
│ 串口发送图像数据   │
│ → PC 上位机        │
└───────┬────────────┘
        ▼
┌────────────────────┐
│ 返回等待下一帧     │
└────────────────────┘



/ / / / / /————python执行流程——————

┌────────────────────┐
│ 初始化环境         │
│ - 打开串口         │
│ - 加载Haar级联分类器│
└───────┬────────────┘
        ▼
┌────────────────────┐
│ 等待串口数据       │
│ (来自 Arduino)     │
└───────┬────────────┘
        ▼
┌────────────────────┐
│ 接收并缓存数据     │
│ - 帧头解析         │
│ - 数据同步         │
└───────┬────────────┘
        ▼
┌────────────────────┐
│ 图像重构           │
│ numpy + reshape    │
└───────┬────────────┘
        ▼
┌────────────────────┐
│ 图像预处理         │
│ - 对比度增强       │
│ - 旋转 / 裁剪      │
└───────┬────────────┘
        ▼
┌────────────────────┐
│     人脸检测         │
└───────┬──────────────┬┘
        │yes           │no
        ▼              ▼
┌─────────────────┐  ┌─────── ──┐
│ 计算人脸中心偏差 │  │ 无执行   │
│ (相对图像中心)   │  └─────┬────┘
└───────┬─────────┘        │
        ▼                  │
┌────────────────────┐     │
│ 生成控制指令       │      │
│ 左 / 右 / 停止     │      │
└───────┬────────────┘     │
        ▼                  │
┌────────────────────┐     │
│ 串口发送控制指令   │      │
│ → Arduino          │     │
└───────┬────────────┘     │
        ▼                  ▼
┌──────────────────────────────┐
│       显示图像与结果        │
└───────┬──────────────────────┘
        ▼
┌────────────────────┐
│ 进入下一帧循环     │
└────────────────────┘
